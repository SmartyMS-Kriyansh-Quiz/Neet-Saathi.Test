<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BIOLOGY DPP-02</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f4f6f9; }
    header { background:#222; color:#fff; padding:15px; text-align:center; position:relative; }
    header h2 { margin:0; }
    header h4 { margin:5px 0 0; font-weight:normal; color:#ffc107; }
    .info-box { position:absolute; left:10px; top:10px; background:#fff; color:#000; padding:8px 12px; border-radius:8px; font-size:13px; line-height:1.4; border:1px solid #ccc; }
    .marking-box { position:absolute; right:10px; top:10px; background:#fff; color:#000; padding:8px 12px; border-radius:8px; font-size:13px; line-height:1.4; border:1px solid #ccc; }
    .container { max-width:900px; margin:20px auto; background:#fff; padding:20px; border-radius:10px; }
    .upload-section, .entry-section { text-align:center; }
    input, button { padding:10px; margin:8px 0; border-radius:8px; border:1px solid #ccc; font-size:16px; }
    #timer { font-weight:bold; color:red; text-align:center; margin:10px 0; }
    .question-img { max-width:100%; border:1px solid #ccc; margin-bottom:10px; }
    .options label { display:block; padding:8px; margin:5px 0; border:2px solid #ccc; border-radius:8px; cursor:pointer; }
    .options input { margin-right:8px; }
    .nav-buttons { display:flex; justify-content:space-between; margin-top:15px; }
    .submit-btn, .view-score-btn, .close-btn { display:none; width:100%; background:#28a745; color:white; padding:12px; border-radius:8px; font-size:16px; font-weight:bold; cursor:pointer; text-align:center; margin-top:20px; }
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:999; justify-content:center; align-items:center; }
    .modal-content { background:#fff; padding:20px; border-radius:10px; max-width:400px; width:90%; text-align:center; }
    .modal-content h3 { margin-bottom:15px; }
    .modal-buttons { display:flex; justify-content:space-around; margin-top:20px; }
    .modal-buttons button { flex:1; margin:0 5px; padding:10px; border-radius:8px; font-weight:bold; }
    .btn-cancel { background:#6c757d; color:#fff; }
    .btn-confirm { background:#007bff; color:#fff; }
    .btn-danger { background:#dc3545; color:#fff; }
    .btn-success { background:#28a745; color:#fff; }
  </style>
</head>
<body>
  <header>
    <div class="info-box"><b>Total Questions: 20</b></div>
    <h2>BIOLOGY DPP-02</h2>
    <h4>Chapter: ‡§µ‡§Ç‡§∂‡§æ‡§ó‡§§‡§ø ‡§î‡§∞ ‡§µ‡§ø‡§µ‡§ø‡§ß‡§§‡§æ ‡§ï‡•á ‡§∏‡§ø‡§¶‡•ç‡§ß‡§æ‡§Ç‡§§</h4>
    <div class="marking-box">
      <b>Marking Scheme</b><br>‚úî If Correct: +4 Marks<br>‚ùå If Wrong: ‚Äì1 Mark
    </div>
  </header>
  <div class="container">
    <div class="entry-section" id="entrySection">
      <input type="text" id="nameInput" placeholder="Enter Your Name" required><br>
      <input type="date" id="dobInput" placeholder="Enter Your DOB" required><br>
      <button id="startTestBtn" disabled>Start Test</button>
    </div>
    <div id="timer"></div>
    <div id="quiz" style="display:none;"></div>
    <button class="submit-btn" id="submitBtn">Submit Test</button>
    <button class="view-score-btn" id="viewScoreBtn">View Score</button>
    <button class="close-btn" id="closeBtn">Close Test</button>
    <div id="resultBox"></div>
  </div>
  <div id="confirmModal" class="modal">
    <div class="modal-content">
      <h3 id="modalMsg"></h3>
      <div class="modal-buttons" id="modalBtns"></div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js";
    const nameInput = document.getElementById('nameInput');
    const dobInput = document.getElementById('dobInput');
    const startTestBtn = document.getElementById('startTestBtn');
    const quizDiv = document.getElementById('quiz');
    const timerDiv = document.getElementById('timer');
    const submitBtn = document.getElementById('submitBtn');
    const viewScoreBtn = document.getElementById('viewScoreBtn');
    const closeBtn = document.getElementById('closeBtn');
    const resultBox = document.getElementById('resultBox');
    const entrySection = document.getElementById('entrySection');
    const modal = document.getElementById('confirmModal');
    const modalMsg = document.getElementById('modalMsg');
    const modalBtns = document.getElementById('modalBtns');
    let questions = [], currentQ = 0, answers = {}, timer, timeLeft = 1200, answerKey = {};
    nameInput.addEventListener('input', checkInputs);
    dobInput.addEventListener('input', checkInputs);
    function checkInputs() {
      startTestBtn.disabled = !nameInput.value || !dobInput.value;
    }
    window.onload = async ()=>{
      const name = nameInput.value;
      const dob = dobInput.value;
      if(localStorage.getItem(name+dob+'attempt')){
        entrySection.innerHTML = '<p>Test already attempted.</p>';
        return;
      }
      const pdf = await pdfjsLib.getDocument('test.pdf').promise;
      const total = pdf.numPages;
      for(let i=1;i<total;i++){
        const page = await pdf.getPage(i);
        const viewport = page.getViewport({scale:1.2});
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = viewport.width;
        canvas.height = viewport.height;
        await page.render({canvasContext:ctx,viewport}).promise;
        const img = canvas.toDataURL('image/png');
        questions.push({id:i, image:img});
      }
      const lastPage = await pdf.getPage(total);
      const txtContent = await lastPage.getTextContent();
      const txt = txtContent.items.map(i=>i.str).join(' ');
      const ansBlocks = [...txt.matchAll(/Ans\.\s*([A-D])/gi)];
      ansBlocks.forEach((match,i)=>{
        answerKey[i] = match[1].toUpperCase();
      });
    };
    startTestBtn.addEventListener('click', ()=>{
      showModal("Are you sure to Start this Test üôÇ", [
        {text:"Back", class:"btn-cancel", action:()=>{}},
        {text:"Start Test", class:"btn-success", action:startTest}
      ]);
    });
    function startTest(){
      const name = nameInput.value.trim();
      const dob = dobInput.value.trim();
      if(localStorage.getItem(name+dob+'attempt')){
        alert("Test already attempted.");
        return;
      }
      localStorage.setItem(name+dob+'attempt','true');
      localStorage.setItem('currentName', name);
      localStorage.setItem('currentDOB', dob);
      entrySection.style.display = 'none';
      quizDiv.style.display = 'block';
      submitBtn.style.display = 'block';
      loadQuestion(0);
      startTimer();
    }
    function startTimer(){
      timer = setInterval(()=>{
        if(timeLeft<=0){clearInterval(timer);submitTest();}
        let h = String(Math.floor(timeLeft/3600)).padStart(2,'0');
        let m = String(Math.floor((timeLeft%3600)/
